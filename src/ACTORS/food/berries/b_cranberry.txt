ACTOR CranberryPlant : BerryPlant
{
	Radius 8
	Height 38
	
	States
	{
	Spawn:
	TNT1 A 0
	BPLN EEEEEEEEEE 1 A_FadeIn(0.1)
	TNT1 A 0 ACS_ExecuteAlways(963, 0, 0) //Set our TID to BERRY_PLANT_TID
	Resting:
		BPLN E -1 //EEEEEE 300
		//BPLN A 0 A_Jump(0,"ChangeToAnother")
		Wait
	
	ChangeToAnother:
	BPLN EEEEEEEEEE 1 A_FadeOut(0.1,false)
	Goto WaitForSpawn
	
	WaitForSpawn:
	TNT1 A 0
	TNT1 A 0 A_NoBlocking
	TNT1 A 0 A_UnsetSolid
	TNT1 A 0 A_SpawnItemEx("BerryRandomizer",0,0,0)
	TNT1 A 1
	Stop
	
	Active:
	BPLN A 0
	BPLN A 0 A_JumpIf(args[0] == 1, "PostHarvest")
	Goto Harvest
	
	Harvest:
	BPLN A 0
	BPLN A 0 A_SetArg(0, 1)
	BPLN A 0 A_SpawnItemEx("CranberryItem",random(-2,2),random(-2,2),random(5,25),random(-4,4),random(-4,4),random(5,12))
	BPLN A 0 A_Jump(64,"PostHarvest")
	BPLN F 1
	Loop
	
	PostHarvest:
	TNT1 A 0
	TNT1 A 0 A_NoBlocking
	TNT1 A 0 A_UnSetShootable
	TNT1 A 0 Thing_ChangeTID(0, 0) //Clear our TID so the 5% killoff doesn't send this plant into a weird state.
	BPLN F 30
	BPLN FFFFFFFFFF 1 A_FadeOut(0.1, false)
	//TNT1 A 0 A_SpawnItemEx("BerryRandomizer",0,0,0)
	Stop
	}
}

ACTOR CranberryItem : BlueberryItem
{
  Tag "Cranberries"
  Inventory.MaxAmount 20
  Inventory.Icon "ZSEIC"
  Inventory.PickupMessage "Picked up a handful of cranberries."
  Scale 1.0
  
  States
  {
	  Spawn:
	    CCHN A 0
		TNT1 A 0 ACS_ExecuteAlways(953, 0, 0) //Set our TID to FOOD_TID so we can spoil
		ZSEP C 10500 //Disappear after 5 minutes
		Stop
	  Use:
		TNT1 A 0
		TNT1 A 0 A_GiveInventory("Health", 5)
		TNT1 A 0 A_TakeInventory("HungerLevel", 5)
		TNT1 A 0 A_PlaySound("eat/crunch")
		TNT1 A 0 ACS_ExecuteAlways(850, 0, 0) //Green screen flash - PLAYER.ACS
		stop

  }
}